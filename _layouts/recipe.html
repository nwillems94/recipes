---
layout: post
---

<h1>{{ page.title }}</h1>

<h2>Ingredients</h2>

<label for="servings">Servings:</label>
<input type="number" id="servings" value="{{ page.servings }}" min="1" onchange="updateIngredients()">

<ul id="ingredientList">
  {% for ingredient in page.ingredients %}
    <li data-quantity="{{ ingredient.quantity }}" data-unit="{{ ingredient.unit }}" data-name="{{ ingredient.name }}">
    {% if ingredient.quantity %}<code><span class="qty">{{ ingredient.quantity }}</span></code>{% endif %} {{ ingredient.unit }} {{ ingredient.name }}
    </li>
  {% endfor %}
</ul>

<hr>

<p>{{ content }}</p>

<script>
  const defaultServings = parseFloat("{{ page.servings }}");

  function formatQuantity(qty) {
    const rounded = Math.round(qty * 100) / 100;
    return Number.isInteger(rounded)
      ? rounded.toString()
      : rounded.toFixed(2).replace(/\.?0+$/, '');
  }

  function updateIngredients() {
    const newServings = parseFloat(document.getElementById('servings').value);
    document.querySelectorAll('#ingredientList li').forEach(item => {
      const baseQty = parseFloat(item.getAttribute('data-quantity'));
      const unit = item.getAttribute('data-unit');
      const name = item.getAttribute('data-name');

      // If there's no numeric base quantity, skip scaling for this ingredient.
      if (isNaN(baseQty)) return;

      const newQty = (baseQty / defaultServings) * newServings;

      const qtySpan = item.querySelector('.qty');
      if (qtySpan) {
        item.querySelector('.qty').textContent = formatQuantity(newQty);
      }
    });
  }
</script>