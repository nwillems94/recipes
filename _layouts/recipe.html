---
layout: post
---

<h1>{{ page.title }}</h1>

<button class="share-button" onclick="shareRecipe()">Share Recipe</button>

<div class="recipe-card">
  <h2>Ingredients</h2>

  <label for="servings">Servings:</label>
  <input type="number" id="servings" value="{{ page.servings }}" min="1" onchange="updateIngredients()">

  <ul id="ingredientList" class="ingredients">
    {% for ingredient in page.ingredients %}
      <li data-quantity="{{ ingredient.quantity }}" data-unit="{{ ingredient.unit }}" data-name="{{ ingredient.name }}">
        {% if ingredient.quantity %}
          <span class="qty">{{ ingredient.quantity }}</span>
        {% endif %}
        {{ ingredient.unit }} {{ ingredient.name }}
      </li>
    {% endfor %}
  </ul>

  <p>{{ content }}</p>
</div>


<script>
  const defaultServings = parseFloat("{{ page.servings }}");

  function formatQuantity(qty) {
    const rounded = Math.round(qty * 100) / 100;
    return Number.isInteger(rounded)
      ? rounded.toString()
      : rounded.toFixed(2).replace(/\.?0+$/, '');
  }

  function updateIngredients() {
    const newServings = parseFloat(document.getElementById('servings').value);
    document.querySelectorAll('#ingredientList li').forEach(item => {
      const baseQty = parseFloat(item.getAttribute('data-quantity'));
      const newQty = (baseQty / defaultServings) * newServings;

      const qtySpan = item.querySelector('.qty');
      if (qtySpan) {
        qtySpan.textContent = formatQuantity(newQty);
      }
    });
  }

  function shareRecipe() {
    if (navigator.share) {
      navigator.share({
        title: document.title,
        url: window.location.href
      }).catch(console.error);
    } else {
      alert('Sharing not supported on this browser.');
    }
  }
</script>
